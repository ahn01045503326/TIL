# 서브쿼리

하나의 SQL 문에 포함되어 있는 또 다른 SQL 문을 말합니다.

---

### 서브쿼리 사용시 주의사항

서브쿼리를 괄호로 감싸서 사용한다.

서브쿼리는 단일 행 또는 복수 행 비교 연산자와 함께 사용 가능하다.

서브쿼리에서는 ORDER BY 를 사용하지 못한다.


### 서브쿼리가 사용 가능한 곳

1. SELECT 절
2. FROM 절
3. WHERE 절
4. HAVING 절
5. ORDER BY 절
6. INSERT 문의 VALUES 절
7. UPDATE 문의 SET 절


### 서브쿼리의 분류
````
단일 행 서브 쿼리
- 서브쿼리가 단일 행 비교 연산자(=, <, <=, >, >=, <>)와 함께 사용할 때는 서브쿼리의 결과 건수가 반드시 1건 이하여야 합니다.
- 만약 결과가 2건 이상인 경우 오류가 발생합니다.
````

````
다중 행 서브쿼리
- 서브쿼리의 결과가 2건 이상 반환될 수 있다면 반드시 다중 행 비교 연산자(IN, ALL, ANY, SOME)와 함께 사용해야 합니다.
````
| 다중 행 연산자 | 설명                                         |
|----------|--------------------------------------------|
| IN       | 서브쿼리의 결과에 존재하는 임의의 값과 동일한 조건을 의미한다.        |
| ALL| 서브쿼리의 결과에 존재하는 모든 값을 만족하는 조건을 의미한다.        |
|ANY| 서브쿼리의 결과에 존재하는 어느 하나의 값이라도 만족하는 조건을 의미한다.  |
|EXISTS| 서브쿼리의 결과를 만족하는 값이 존재하는지 여부를 확인하는 조건을 의미한다. |


### SQL 작성시 주의사항
- MySQL에서 UPDATE & DELETE를 할 때 자기 테이블의 데이터를 바로 사용하면 에러나므로 서브쿼리에 대해서 임시 테이블을 만들어 사용

````
MySQL 5.6 버전 이후부터는 서브쿼리에서 자기 테이블을 참조하는 경우도 문제 없이 동작하도록 개선
````